<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IELTS Writing Assessor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">IELTS Writing<span class="pill"></span></div>
      <div style="display: flex; align-items: center; gap: 16px;">
        <div class="chips">
          <span class="chip">Task 2 Essays</span>
          <span class="chip">JSON-parsed feedback</span>
          <span class="chip">100+ topics</span>
        </div>
        <button id="settingsBtn" class="btn ghost" title="Settings" style="padding: 8px;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
      </div>
    </header>

    <div id="settingsPanel" class="card" style="display: none; margin-bottom: 16px;">
      <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
        <h3 style="margin:0;">Settings</h3>
        <button id="closeSettingsBtn" title="Close Settings" class="btn ghost" style="width: auto; padding: 4px 8px; font-size: 20px; line-height: 1;">&times;</button>
      </div>
      <div class="row">
        <div>
          <label>Gemini API Key</label>
          <input id="apiKey" type="password" placeholder="AIza... (stored locally)" />
          <div class="hint mono">Saved Locally</div>
        </div>
        <div>
          <label>Model</label>
          <input id="modelName" type="text" value="gemini-2.5-flash" />
          <div class="hint mono">Use a model you have access to.</div>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>Target Band (optional)</label>
          <select id="targetBand">
            <option value="">â€” none â€”</option>
            <option>6.0</option><option>6.5</option><option>7.0</option><option>7.5</option>
            <option>8.0</option><option>8.5</option><option>9.0</option>
          </select>
          <div class="hint small">Advice will be tailored to this goal.</div>
        </div>
        <div>
          <label>Max Output Tokens</label>
          <input id="maxTokens" type="number" value="1000000" min="256" step="128" />
        </div>
      </div>
      <div class="controls" style="margin-top: 16px; justify-content: flex-end;">
          <button class="btn ghost" id="saveBtn">Save API Key</button>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT: Inputs -->
      <section class="card">
        <label>Choose an IELTS Topic</label>
        <div class="topic-bar">
          <select id="topicSelect"></select>
          <button class="btn" id="randTopic" title="Random topic">Random</button>
          <button class="btn ghost" id="useCustom">Use custom below</button>
        </div>
        <label style="margin-top:10px">Or write your own topic/question</label>
        <textarea id="customTopic" placeholder="e.g., Some people think the best way to reduce crime is to give longer prison sentences. Others believe there are better ways to reduce crime. Discuss both views and give your own opinion."></textarea>

        <label style="margin-top:10px">Your Writing</label>
        <textarea id="essay" placeholder="Paste or write your full response here..."></textarea>

        <div class="controls">
          <button class="btn primary" id="assessBtn">Assess Writing</button>
          <button class="btn" id="clearBtn">Clear</button>
        </div>
        <div id="status" class="hint mono" style="margin-top:8px"></div>
      </section>

      <!-- RIGHT: Results -->
      <section class="card" id="resultsCard">
        <div class="overall">
          <div>
            <div class="small" style="color:var(--ink-dim)">Overall IELTS Band</div>
            <div class="scoreBig" id="overallBand">â€“</div>
          </div>
          <div>
            <div class="small" style="color:var(--ink-dim)">Breakdown</div>
            <div class="chips" id="breakdownChips"></div>
          </div>
        </div>

        <div class="results">
          <div class="crit" id="crit-ta" data-band=""><h3>1. Task Achievement</h3><div class="content"></div></div>
          <div class="crit" id="crit-cc" data-band=""><h3>2. Coherence & Cohesion</h3><div class="content"></div></div>
          <div class="crit" id="crit-lr" data-band=""><h3>3. Lexical Resource</h3><div class="content"></div></div>
          <div class="crit" id="crit-gra" data-band=""><h3>4. Grammatical Range & Accuracy</h3><div class="content"></div></div>
          
          <div class="card" style="background:transparent; border-style:dashed">
            <h3 style="margin:0 0 8px 0">Inline Issues</h3>
            <div class="hint">Problematic excerpts detected in your writing are highlighted below. Click an issue to see details.</div>
            <div id="inlinePreview" class="essay-preview" style="margin-top:10px"></div>
          </div>
       
          <div class="card" style="background:transparent; border-style:dashed">
            <h3 style="margin:0 0 8px 0">All Errors & Suggestions</h3>
            <ol id="errorsList" class="errors"></ol>
          </div>
           <div class="card" style="background:transparent; border-style:dashed">
            <h3 style="margin:0 0 8px 0">Band 9 Model Answer</h3>
            <div class="hint">This is a rewritten version of your essay, demonstrating how to achieve a top score.</div>
            <div id="refinedEssay" class="essay-preview" style="margin-top:10px"></div>
          </div>
          <details>
            <summary class="small">Show raw JSON (debug)</summary>
            <pre id="rawJson" class="mono"></pre>
          </details>
        </div>
      </section>
    </div>

    <div class="footer">Made with ðŸ’™ by Hamim.</div>
  </div>

<script src="scripts.js">
</script>
</body>
</html>
